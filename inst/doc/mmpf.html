<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Zachary M. Jones" />

<meta name="date" content="2016-11-11" />

<title>Monte-Carlo Methods for Prediction Functions</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Monte-Carlo Methods for Prediction Functions</h1>
<h4 class="author"><em>Zachary M. Jones</em></h4>
<h4 class="date"><em>2016-11-11</em></h4>



<p>This packages allows you to to marginalize arbitrary prediction functions using Monte-Carlo integration. Since many prediction functions cannot be easily decomposed into a sum of low dimensional components marginalization can be helpful in making these functions interpretable.</p>
<p><code>marginalPrediction</code> does this computation and then evaluates the marginalized function at a set grid points, which can be uniformly created, subsampled from the training data, or explicitly specified as an argument.</p>
<p>The create of a uniform grid is handled by the <code>variableGrid</code> method. If <code>uniform = FALSE</code> and the <code>points</code> argument isnâ€™t used to specify what points to evaluate, a sample of size <code>n[1]</code> is taken from the data without replacement.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mmpf)
<span class="kw">library</span>(randomForest)</code></pre></div>
<pre><code>## randomForest 4.6-12</code></pre>
<pre><code>## Type rfNews() to see new features/changes/bug fixes.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(swiss)

fit =<span class="st"> </span><span class="kw">randomForest</span>(Fertility ~<span class="st"> </span>., swiss)
<span class="kw">marginalPrediction</span>(swiss[, -<span class="dv">1</span>], <span class="st">&quot;Education&quot;</span>, <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">25</span>), fit)</code></pre></div>
<pre><code>## $prediction
##  [1] 73.16719 74.55362 73.63688 60.89975 65.07203 63.87359 66.01385
##  [8] 65.16879 57.31980 64.23191
## 
## $points
##    Education
## 1          1
## 2          7
## 3         13
## 4         18
## 5         24
## 6         30
## 7         36
## 8         41
## 9         47
## 10        53</code></pre>
<p>The output of <code>marginalPrediction</code> is always a list with two elements, <code>prediction</code> and <code>points</code>.</p>
<p>By default the Monte-Carlo expectation is computed, which is set by the <code>aggregate.fun</code> argumentâ€™s default value, the <code>mean</code> function. Substituting, say, the median, would give a different output.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">marginalPrediction</span>(swiss[, -<span class="dv">1</span>], <span class="st">&quot;Education&quot;</span>, <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">25</span>), fit, <span class="dt">aggregate.fun =</span> identity)</code></pre></div>
<pre><code>## $prediction
##           [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]
##  [1,] 74.34694 62.63832 67.28735 82.51371 72.28726 74.34694 62.63832
##  [2,] 61.82900 80.82552 64.74449 66.55270 67.69200 61.82900 80.82552
##  [3,] 70.87189 76.16749 65.51442 70.08724 74.97268 70.87189 76.16749
##  [4,] 61.70607 75.46225 68.62768 60.03769 60.78013 61.70607 75.46225
##  [5,] 74.35020 69.80041 72.00466 71.91332 67.71496 74.35020 69.80041
##  [6,] 74.98962 63.32124 65.76482 54.41933 57.34750 74.98962 63.32124
##  [7,] 58.53077 60.83246 54.46824 73.12793 56.42593 58.53077 60.83246
##  [8,] 62.50785 66.56272 64.13558 68.06267 57.21571 62.50785 66.56272
##  [9,] 55.45441 56.45508 58.79520 72.72766 65.71551 55.45441 56.45508
## [10,] 71.51427 67.10101 73.85122 68.93235 71.59276 71.51427 67.10101
##           [,8]     [,9]    [,10]    [,11]    [,12]    [,13]    [,14]
##  [1,] 67.28735 82.51371 72.28726 74.34694 62.63832 67.28735 82.51371
##  [2,] 64.74449 66.55270 67.69200 61.82900 80.82552 64.74449 66.55270
##  [3,] 65.51442 70.08724 74.97268 70.87189 76.16749 65.51442 70.08724
##  [4,] 68.62768 60.03769 60.78013 61.70607 75.46225 68.62768 60.03769
##  [5,] 72.00466 71.91332 67.71496 74.35020 69.80041 72.00466 71.91332
##  [6,] 65.76482 54.41933 57.34750 74.98962 63.32124 65.76482 54.41933
##  [7,] 54.46824 73.12793 56.42593 58.53077 60.83246 54.46824 73.12793
##  [8,] 64.13558 68.06267 57.21571 62.50785 66.56272 64.13558 68.06267
##  [9,] 58.79520 72.72766 65.71551 55.45441 56.45508 58.79520 72.72766
## [10,] 73.85122 68.93235 71.59276 71.51427 67.10101 73.85122 68.93235
##          [,15]    [,16]    [,17]    [,18]    [,19]    [,20]    [,21]
##  [1,] 72.28726 74.34694 62.63832 67.28735 82.51371 72.28726 74.34694
##  [2,] 67.69200 61.82900 80.82552 64.74449 66.55270 67.69200 61.82900
##  [3,] 74.97268 70.87189 76.16749 65.51442 70.08724 74.97268 70.87189
##  [4,] 60.78013 61.70607 75.46225 68.62768 60.03769 60.78013 61.70607
##  [5,] 67.71496 74.35020 69.80041 72.00466 71.91332 67.71496 74.35020
##  [6,] 57.34750 74.98962 63.32124 65.76482 54.41933 57.34750 74.98962
##  [7,] 56.42593 58.53077 60.83246 54.46824 73.12793 56.42593 58.53077
##  [8,] 57.21571 62.50785 66.56272 64.13558 68.06267 57.21571 62.50785
##  [9,] 65.71551 55.45441 56.45508 58.79520 72.72766 65.71551 55.45441
## [10,] 71.59276 71.51427 67.10101 73.85122 68.93235 71.59276 71.51427
##          [,22]    [,23]    [,24]    [,25]
##  [1,] 62.63832 67.28735 82.51371 72.28726
##  [2,] 80.82552 64.74449 66.55270 67.69200
##  [3,] 76.16749 65.51442 70.08724 74.97268
##  [4,] 75.46225 68.62768 60.03769 60.78013
##  [5,] 69.80041 72.00466 71.91332 67.71496
##  [6,] 63.32124 65.76482 54.41933 57.34750
##  [7,] 60.83246 54.46824 73.12793 56.42593
##  [8,] 66.56272 64.13558 68.06267 57.21571
##  [9,] 56.45508 58.79520 72.72766 65.71551
## [10,] 67.10101 73.85122 68.93235 71.59276
## 
## $points
##    Education
## 1          1
## 2          7
## 3         13
## 4         18
## 5         24
## 6         30
## 7         36
## 8         41
## 9         47
## 10        53</code></pre>
<p>By passing the identity function to <code>aggregate.fun</code>, which simply returns its input exactly, the integration points are returned directly so that the <code>prediction</code> element of the return is a matrix of dimension <code>n</code>.</p>
<p><code>marginalPrediction</code> can also handle cases in which predictions for a single data point are vector-valued. That is, classification tasks where probabilities are output, and multivariate regression and/or classification. In these cases <code>aggregate.fun</code> is applied separately to each column of the prediction matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(iris)

fit =<span class="st"> </span><span class="kw">randomForest</span>(Species ~<span class="st"> </span>., iris)
<span class="kw">marginalPrediction</span>(iris[, -<span class="kw">ncol</span>(iris)], <span class="st">&quot;Sepal.Width&quot;</span>, <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">25</span>), fit,
  <span class="dt">predict.fun =</span> function(object, newdata) <span class="kw">predict</span>(object, <span class="dt">newdata =</span> newdata, <span class="dt">type =</span> <span class="st">&quot;prob&quot;</span>))</code></pre></div>
<pre><code>## $prediction
##         [,1]   [,2]   [,3]
##  [1,] 0.5784 0.4112 0.0104
##  [2,] 0.1936 0.2580 0.5484
##  [3,] 0.0000 0.3964 0.6036
##  [4,] 0.1976 0.2604 0.5420
##  [5,] 0.4016 0.3972 0.2012
##  [6,] 0.6016 0.3980 0.0004
##  [7,] 0.2108 0.2820 0.5072
##  [8,] 0.0252 0.3968 0.5780
##  [9,] 0.2092 0.2784 0.5124
## [10,] 0.4204 0.3780 0.2016
## 
## $points
##    Sepal.Width
## 1     2.000000
## 2     2.266667
## 3     2.533333
## 4     2.800000
## 5     3.066667
## 6     3.333333
## 7     3.600000
## 8     3.866667
## 9     4.133333
## 10    4.400000</code></pre>
<p>In all of the aforementioned cases <code>vars</code> can include multiple variables. In this case the Cartesian product of each variableâ€™s grid is taken (however that is created), resulting in an at-most <code>n[1]^length(vars)</code> unique points. This number can be reduced if <code>n[1]</code> is less than the unique number of values for one of the variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">marginalPrediction</span>(iris[, -<span class="kw">ncol</span>(iris)], <span class="kw">c</span>(<span class="st">&quot;Sepal.Width&quot;</span>, <span class="st">&quot;Sepal.Length&quot;</span>), <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">25</span>), fit,
  <span class="dt">predict.fun =</span> function(object, newdata) <span class="kw">predict</span>(object, <span class="dt">newdata =</span> newdata, <span class="dt">type =</span> <span class="st">&quot;prob&quot;</span>))</code></pre></div>
<pre><code>## $prediction
##        [,1]  [,2]  [,3]
##  [1,] 0.004 0.396 0.600
##  [2,] 0.974 0.024 0.002
##  [3,] 1.000 0.000 0.000
##  [4,] 0.026 0.264 0.710
##  [5,] 1.000 0.000 0.000
##  [6,] 0.000 0.950 0.050
##  [7,] 0.000 0.086 0.914
##  [8,] 0.026 0.144 0.830
##  [9,] 1.000 0.000 0.000
## [10,] 0.026 0.164 0.810
## [11,] 0.000 0.960 0.040
## [12,] 0.000 0.972 0.028
## [13,] 0.000 0.020 0.980
## [14,] 0.056 0.932 0.012
## [15,] 0.984 0.016 0.000
## [16,] 0.920 0.078 0.002
## [17,] 0.000 0.000 1.000
## [18,] 0.920 0.078 0.002
## [19,] 0.000 0.000 1.000
## [20,] 0.048 0.938 0.014
## [21,] 0.000 0.008 0.992
## [22,] 0.920 0.068 0.012
## [23,] 0.000 0.886 0.114
## [24,] 0.966 0.026 0.008
## [25,] 0.000 0.000 1.000
## 
## $points
##    Sepal.Width Sepal.Length
## 1          2.0          4.3
## 2          2.6          4.3
## 3          3.2          4.3
## 4          3.8          4.3
## 5          4.4          4.3
## 6          2.0          5.2
## 7          2.6          5.2
## 8          3.2          5.2
## 9          3.8          5.2
## 10         4.4          5.2
## 11         2.0          6.1
## 12         2.6          6.1
## 13         3.2          6.1
## 14         3.8          6.1
## 15         4.4          6.1
## 16         2.0          7.0
## 17         2.6          7.0
## 18         3.2          7.0
## 19         3.8          7.0
## 20         4.4          7.0
## 21         2.0          7.9
## 22         2.6          7.9
## 23         3.2          7.9
## 24         3.8          7.9
## 25         4.4          7.9</code></pre>
<p>Permutation importance is a Monte-Carlo method which estimates the importance of variables in determining predictions by computing the change from repeatedly permuting the values of those variables, and comparing the prediction error using the permuted data to the error on the unpermuted training data.</p>
<p><code>permutationImportance</code> can compute this type of importance under arbitrary loss (with respect to the observed target) functions and contrast (between the loss with the unpermuted and permuted data).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">permutationImportance</span>(iris, <span class="st">&quot;Sepal.Width&quot;</span>, <span class="st">&quot;Species&quot;</span>, fit)</code></pre></div>
<pre><code>## [1] 0.01226667</code></pre>
<p>For methods which generate predictions which are characters or unordered factors, the default loss function is the mean misclassification error. For all other types of predictions mean squared error is used.</p>
<p>It is, for example, possible to compute the expected change in the mean misclassification rate by class. The two arguments to <code>loss.fun</code> are the permuted predictions and the target variable. In this case they are both vectors of factors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">permutationImportance</span>(iris, <span class="st">&quot;Sepal.Width&quot;</span>, <span class="st">&quot;Species&quot;</span>, fit,
  <span class="dt">loss.fun =</span> function(x, y) {
    mat =<span class="st"> </span><span class="kw">table</span>(x, y)
    n =<span class="st"> </span><span class="kw">colSums</span>(mat)
    <span class="kw">diag</span>(mat) =<span class="st"> </span><span class="dv">0</span>
    <span class="kw">rowSums</span>(mat) /<span class="st"> </span>n
  },
  <span class="dt">contrast.fun =</span> function(x, y) x -<span class="st"> </span>y)</code></pre></div>
<pre><code>##     setosa versicolor  virginica 
##     0.0000     0.0256     0.0126</code></pre>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
